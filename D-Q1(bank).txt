1. Design and develop SQL DDL and DML statements to manage the bank database as manage customers, their bank accounts, and transactions (balances, deposits and withdrawals) in a bank. Also execute queries for following: 1. Find total deposits per account type. 2. List all transactions in descending order of date. 3. Find customers whose balance is above the average balance. 4. List all customers living in “Mumbai”. 5. Delete a transaction older than 30 days.

CREATE TABLE Customer (
    cust_id INT PRIMARY KEY,
    name VARCHAR(50),
    city VARCHAR(30)
);

CREATE TABLE Account (
    acc_id INT PRIMARY KEY,
    cust_id INT,
    acc_type VARCHAR(20),
    balance DECIMAL(10,2),
    FOREIGN KEY (cust_id) REFERENCES Customer(cust_id)
);

CREATE TABLE Transaction (
    trans_id INT PRIMARY KEY,
    acc_id INT,
    trans_date DATE,
    trans_type VARCHAR(20),   -- Deposit / Withdrawal
    amount DECIMAL(10,2),
    FOREIGN KEY (acc_id) REFERENCES Account(acc_id)
);

INSERT INTO Customer VALUES
(1,'Amit','Mumbai'),
(2,'Sara','Pune'),
(3,'John','Mumbai');

INSERT INTO Account VALUES
(101,1,'Savings',50000),
(102,2,'Current',20000),
(103,3,'Savings',80000);

INSERT INTO Transaction VALUES
(1001,101,'2025-01-01','Deposit',5000),
(1002,102,'2025-01-05','Withdrawal',2000),
(1003,103,'2025-02-01','Deposit',10000);


Q1) Find total deposits per account type.
SELECT acc_type, SUM(balance) AS total_balance
FROM Account
GROUP BY acc_type;

Q2) List all transactions in descending order of date.
SELECT * FROM Transaction
ORDER BY trans_date DESC;

Q3) Find customers whose balance is above the average balance.
SELECT c.name, a.balance
FROM Customer c
JOIN Account a ON c.cust_id = a.cust_id
WHERE a.balance > (SELECT AVG(balance) FROM Account)

Q4) List all customers living in “Mumbai”.
SELECT * FROM Customer
WHERE city = 'Mumbai';

Q5) Delete a transaction older than 30 days.
DELETE FROM Transaction
WHERE trans_date < (CURRENT_DATE - INTERVAL 30 DAY);